<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PDF –†–µ–¥–∞–∫—Ç–æ—Ä</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        input, textarea {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1a1a1a;
            padding: 0;
            min-height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .layout {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .top-toolbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            flex-shrink: 0;
        }

        .left-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 12px;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(15px);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.25);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .logo-icon {
            font-size: 28px;
            filter: drop-shadow(0 2px 6px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .logo-title {
            font-size: 18px;
            font-weight: 900;
            color: white;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .logo-subtitle {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255,255,255,0.75);
            letter-spacing: 1px;
        }

        .page-nav-section {
            display: flex;
            gap: 6px;
            align-items: center;
            background: rgba(255,255,255,0.1);
            padding: 4px 8px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .page-nav-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .page-nav-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .page-counter {
            color: white;
            font-size: 12px;
            font-weight: 600;
            min-width: 50px;
            text-align: center;
        }

        .right-section {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .content-area {
            flex: 1;
            overflow: hidden;
            display: flex;
            background: #f5f5f5;
        }

        .pdf-container {
            flex: 1;
            overflow: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .pdf-viewer {
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            max-width: 90%;
            max-height: 90%;
            overflow: hidden;
        }

        canvas {
            display: block;
            image-rendering: crisp-edges;
        }

        .toolbar-bottom {
            background: white;
            padding: 12px 16px;
            display: flex;
            gap: 12px;
            align-items: center;
            border-top: 1px solid #e0e0e0;
            flex-shrink: 0;
        }

        .input-file {
            display: none;
        }

        .file-input-label {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <div class="layout">
        <div class="top-toolbar">
            <div class="left-section">
                <div class="logo-section">
                    <div class="logo-icon">üìÑ</div>
                    <div class="logo-text">
                        <div class="logo-title">PDF –†–µ–¥–∞–∫—Ç–æ—Ä</div>
                        <div class="logo-subtitle">–ü–†–û–°–¢–û–ô –ò–ù–¢–ï–†–§–ï–ô–°</div>
                    </div>
                </div>
                <div class="page-nav-section">
                    <button class="page-nav-btn" id="prevBtn">‚óÄ</button>
                    <div class="page-counter"><span id="currentPage">0</span> / <span id="totalPages">0</span></div>
                    <button class="page-nav-btn" id="nextBtn">‚ñ∂</button>
                </div>
            </div>
            <div class="right-section">
                <button class="action-btn" id="zoomInBtn" title="–£–≤–µ–ª–∏—á–∏—Ç—å">üîç+</button>
                <button class="action-btn" id="zoomOutBtn" title="–£–º–µ–Ω—å—à–∏—Ç—å">üîç‚àí</button>
                <button class="action-btn" id="rotateBtn" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å">‚Üª</button>
                <button class="action-btn" id="printBtn" title="–ü–µ—á–∞—Ç—å">üñ®Ô∏è</button>
            </div>
        </div>

        <div class="content-area">
            <div class="pdf-container">
                <div class="pdf-viewer">
                    <canvas id="pdfCanvas"></canvas>
                </div>
            </div>
        </div>

        <div class="toolbar-bottom">
            <label class="file-input-label" for="fileInput">üìÅ –û—Ç–∫—Ä—ã—Ç—å PDF</label>
            <input type="file" id="fileInput" class="input-file" accept=".pdf">
            <button class="action-btn" id="extractBtn" title="–ò–∑–≤–ª–µ—á—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã">üìë –ò–∑–≤–ª–µ—á—å</button>
            <button class="action-btn" id="cropBtn" title="–û–±—Ä–µ–∑–∞—Ç—å –æ–±–ª–∞—Å—Ç—å">‚úÇÔ∏è –û–±—Ä–µ–∑–∞—Ç—å</button>
            <button class="action-btn" id="saveBtn" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script>
        let pdfDoc = null;
        let currentPage = 1;
        let scale = 1.5;
        let rotation = 0;

        const canvas = document.getElementById('pdfCanvas');
        const ctx = canvas.getContext('2d');
        const fileInput = document.getElementById('fileInput');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const currentPageSpan = document.getElementById('currentPage');
        const totalPagesSpan = document.getElementById('totalPages');
        const zoomInBtn = document.getElementById('zoomInBtn');
        const zoomOutBtn = document.getElementById('zoomOutBtn');
        const rotateBtn = document.getElementById('rotateBtn');
        const printBtn = document.getElementById('printBtn');
        const saveBtn = document.getElementById('saveBtn');

        // –ó–∞–≥—Ä—É–∑–∫–∞ PDF
        fileInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    pdfDoc = await pdfjsLib.getDocument(event.target.result).promise;
                    currentPage = 1;
                    totalPagesSpan.textContent = pdfDoc.numPages;
                    renderPage();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PDF:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ PDF —Ñ–∞–π–ª–∞');
                }
            };
            reader.readAsArrayBuffer(file);
        });

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        async function renderPage() {
            if (!pdfDoc) return;

            const page = await pdfDoc.getPage(currentPage);
            const viewport = page.getViewport({ scale: scale });

            canvas.width = viewport.width;
            canvas.height = viewport.height;

            const renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };

            try {
                await page.render(renderContext).promise;
                currentPageSpan.textContent = currentPage;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);
            }
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
        prevBtn.addEventListener('click', () => {
            if (pdfDoc && currentPage > 1) {
                currentPage--;
                renderPage();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (pdfDoc && currentPage < pdfDoc.numPages) {
                currentPage++;
                renderPage();
            }
        });

        // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
        zoomInBtn.addEventListener('click', () => {
            scale += 0.25;
            renderPage();
        });

        zoomOutBtn.addEventListener('click', () => {
            if (scale > 0.5) {
                scale -= 0.25;
                renderPage();
            }
        });

        // –ü–µ—á–∞—Ç—å
        printBtn.addEventListener('click', () => {
            window.print();
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        saveBtn.addEventListener('click', async () => {
            if (!pdfDoc) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ PDF —Ñ–∞–π–ª');
                return;
            }
            
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = `page-${currentPage}.png`;
            link.click();
        });
    </script>
</body>
</html>
